if (self.CavalryLogger) { CavalryLogger.start_js(["xiSec"]); }

/**
 * License: https://www.facebook.com/legal/license/i7wymvhn6QY/
 */
__d("sha256",["str2rstr"],(function(a,b,c,d,e,f){__p&&__p();var g=b("str2rstr");function h(a,b){return b>>>a|b<<32-a}function i(a,b,c){return a&b^~a&c}function j(a,b,c){return a&b^a&c^b&c}function k(a){return h(2,a)^h(13,a)^h(22,a)}function l(a){return h(6,a)^h(11,a)^h(25,a)}function m(a){return h(7,a)^h(18,a)^a>>>3}function n(a){return h(17,a)^h(19,a)^a>>>10}function o(a,b){return a[b&15]+=n(a[b+14&15])+a[b+9&15]+m(a[b+1&15])}var p=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),q=new Array(8),r=new Array(2),s=new Array(64),t=new Array(16),u="0123456789abcdef";function v(a,b){var c=(a&65535)+(b&65535);a=(a>>16)+(b>>16)+(c>>16);return a<<16|c&65535}function w(){r[0]=r[1]=0,q[0]=1779033703,q[1]=3144134277,q[2]=1013904242,q[3]=2773480762,q[4]=1359893119,q[5]=2600822924,q[6]=528734635,q[7]=1541459225}function x(){__p&&__p();var a,b,c,d,e,f,g,h,m,n;a=q[0];b=q[1];c=q[2];d=q[3];e=q[4];f=q[5];g=q[6];h=q[7];for(var r=0;r<16;r++)t[r]=s[(r<<2)+3]|s[(r<<2)+2]<<8|s[(r<<2)+1]<<16|s[r<<2]<<24;for(var r=0;r<64;r++)m=h+l(e)+i(e,f,g)+p[r],r<16?m+=t[r]:m+=o(t,r),n=k(a)+j(a,b,c),h=g,g=f,f=e,e=v(d,m),d=c,c=b,b=a,a=v(m,n);q[0]+=a;q[1]+=b;q[2]+=c;q[3]+=d;q[4]+=e;q[5]+=f;q[6]+=g;q[7]+=h}function y(a,b){__p&&__p();var c,d,e=0;d=r[0]>>3&63;var f=b&63;(r[0]+=b<<3)<b<<3&&r[1]++;r[1]+=b>>29;for(c=0;c+63<b;c+=64){for(var g=d;g<64;g++)s[g]=a.charCodeAt(e++);x();d=0}for(var g=0;g<f;g++)s[g]=a.charCodeAt(e++)}function z(){__p&&__p();var a=r[0]>>3&63;s[a++]=128;if(a<=56)for(var b=a;b<56;b++)s[b]=0;else{for(var b=a;b<64;b++)s[b]=0;x();for(var b=0;b<56;b++)s[b]=0}s[56]=r[1]>>>24&255;s[57]=r[1]>>>16&255;s[58]=r[1]>>>8&255;s[59]=r[1]&255;s[60]=r[0]>>>24&255;s[61]=r[0]>>>16&255;s[62]=r[0]>>>8&255;s[63]=r[0]&255;x()}function A(){var a=new String();for(var b=0;b<8;b++)for(var c=28;c>=0;c-=4)a+=u.charAt(q[b]>>>c&15);return a}function B(a){var b=0;for(var c=0;c<8;c++)for(var d=28;d>=0;d-=4)a[b++]=u.charCodeAt(q[c]>>>d&15)}function C(b,a){w();y(b,b.length);z();if(a)B(a);else return A()}function a(b,c,a){if(b===null||b===void 0)return null;c=typeof c=="undefined"?!0:c;c&&(b=g(b));return C(b,a)}e.exports=a}),null);
__d("QuickSandHeader",["Int64","sha256"],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";__p&&__p();function a(a,c){__p&&__p();this.$1=1<<c;this.$2=this.$1/2;this.$3=b("Int64").fromInt(this.$2-1);this.$4=[];this.$5=0;this.$6=0;this.$7=0;this.$8=0;c=b("sha256")(a);a=this.$9(this.$10(c));c=this.$9(this.$10(c).slice(8));this.$4.push(a.xor(b("Int64").fromString("736f6d6570736575",16)));this.$4.push(c.xor(b("Int64").fromString("646f72616e646f6d",16)));this.$4.push(a.xor(b("Int64").fromString("6c7967656e657261",16)));this.$4.push(c.xor(b("Int64").fromString("7465646279746573",16)))}var c=a.prototype;c.sipEdge=function(a){return[this.sipNode(a,0),this.sipNode(a,1)]};c.sipNode=function(a,b){return this.$11(2*a+b).and(this.$3).toInt()};c.getSize=function(){return this.$1};c.getHalfSize=function(){return this.$2};c.$12=function(a,b){return a.shiftLeft(b).or(a.shiftRightUnsigned(64-b))};c.$9=function(a){var c=new(b("Int64").fromInt)(a[0]),d=b("Int64").fromInt(a[1]).shiftLeft(8),e=b("Int64").fromInt(a[2]).shiftLeft(16),f=b("Int64").fromInt(a[3]).shiftLeft(24),g=b("Int64").fromInt(a[4]).shiftLeft(32),h=b("Int64").fromInt(a[5]).shiftLeft(40),i=b("Int64").fromInt(a[6]).shiftLeft(48);a=b("Int64").fromInt(a[7]).shiftLeft(56);return c.or(d).or(e).or(f).or(g).or(h).or(i).or(a)};c.$13=function(){this.$5=this.$5.add(this.$6),this.$7=this.$7.add(this.$8),this.$6=this.$12(this.$6,13),this.$8=this.$12(this.$8,16),this.$6=this.$6.xor(this.$5),this.$8=this.$8.xor(this.$7),this.$5=this.$12(this.$5,32),this.$7=this.$7.add(this.$6),this.$5=this.$5.add(this.$8),this.$6=this.$12(this.$6,17),this.$8=this.$12(this.$8,21),this.$6=this.$6.xor(this.$7),this.$8=this.$8.xor(this.$5),this.$7=this.$12(this.$7,32)};c.$10=function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b};c.$11=function(a){__p&&__p();a=b("Int64").fromInt(a);this.$5=this.$4[0];this.$6=this.$4[1];this.$7=this.$4[2];this.$8=this.$4[3].xor(a);for(var c=0;c<2;c++)this.$13();this.$5=this.$5.xor(a);this.$7=this.$7.xor(b("Int64").fromString("ff",16));for(c=0;c<4;c++)this.$13();return this.$5.xor(this.$6).xor(this.$7).xor(this.$8)};return a}();e.exports=a}),null);
__d("QuickSandSolver",["AsyncRequest","Base64","Form","QuickSandHeader","sha256"],(function(a,b,c,d,e,f){__p&&__p();var g={solveAndEncode:function(a,c,d,e,f,g){a=JSON.stringify([this.solve(a,c,d,e,f),g]);return b("Base64").encode(a)},solveAndUpdateForm:function(a,c,d,e,f,g,h){a=this.solveAndEncode(a,c,d,e,f,h);c=document.getElementById(g);b("Form").createHiddenInputs({qsstamp:a},c)},solveAndSendRequestBack:function(a,b){b=this.solveAndEncode(b.__iterations,b.__header,b.__graphSizeShift,b.__proofSize,b.__edgePercentage,b.__blob);a.data.qsstamp=b;a.send()},solveAndCallAsyncController:function(a,c,d,e,f,g){a=this.solveAndEncode(a,c,d,e,f,g);new(b("AsyncRequest"))().setURI("/qs/").setData({qsstamp:a}).send()},solve:function(a,b,c,d,e){var f=[];b=b;for(var h=0;h<a;h++)f.push(g.solveOneIteration(b,c,d,e)),b=g.hashList(f[h]);return f},solveOneIteration:function(a,c,d,e){__p&&__p();var f=8192;a=new(b("QuickSandHeader"))(a,c);c=e*a.getSize()/100;e=[];var h=[],i=[];for(var j=0;j<c;j++){var k=a.sipEdge(j),l=k[0];k=k[1];l+=1;k+=1+a.getHalfSize();var m=e[l],n=e[k];if(m==k||n==l)continue;h[0]=l;i[0]=k;m=g.path(m,h,e,f);n=g.path(n,i,e,f);if(h[m]==i[n]){var o=Math.min(m,n);for(m-=o,n-=o;h[m]!=i[n];m++,n++);o=m+n+1;if(o==d)return g.recoverSolution(m,n,h,i,a,d,c);continue}if(m<n){while(m--)e[h[m+1]]=h[m];e[l]=k}else{while(n--)e[i[n+1]]=i[n];e[k]=l}}return[]},path:function(a,b,c,d){__p&&__p();var e;for(e=0;a;a=c[a]){if(++e>=d){while(e--&&b[e]!=a);if(e<0)throw new Error("Maximum path length was exceeded");else throw new Error("Illegal cycle has occurred")}b[e]=a}return e},recoverSolution:function(a,b,c,d,e,f,g){__p&&__p();f=function(){};f.prototype.add=function(a){this[a]=!0};f.prototype.remove=function(a){delete this[a]};var h=[];f=new f();f.add([c[0],d[0]]);while(a--)f.add([c[a+1&-2],c[a|1]]);while(b--)f.add([d[b|1],d[b+1&-2]]);a=0;for(var c=0;c<g;c++){b=[1+e.sipNode(c,0),1+e.getHalfSize()+e.sipNode(c,1)];b in f&&(h[a++]=c,f.remove(b))}return h},hashList:function(a){a=a.join("-");return b("sha256")(a)}};e.exports=g}),null);